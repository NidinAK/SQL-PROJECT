-- CHECKING WHETHER THE DATA IS CORRECTLY IMPORTED
SELECT * FROM order_details;
SELECT * FROM orders;
SELECT * FROM pizza_types;
SELECT * FROM pizzas;

-- BASIC LEVEL OF ANALYSIS
-- 1] TOTAL ORDERS PLACE
SELECT COUNT(DISTINCT order_id) AS "TOTAL ORDERS"
FROM orders;

-- 2] CALCULATING TOTAL REVENUE
-- 2.1] GET TO KNOW THE DETAILS
SELECT od.pizza_id, od.quantity, p.price
FROM order_details od
INNER JOIN pizzas p
ON od.pizza_id = p.pizza_id;

-- 2.2] NOW CALCULATING THE REVENUE
SELECT ROUND(SUM(od.quantity * p.price),2) AS "TOTAL REVENUE"
FROM order_details od
INNER JOIN pizzas p
ON od.pizza_id = p.pizza_id;

-- 3] IDENTIFYING THE HIGHEST PRICED PIZZA
SELECT pt.name, p.price as "HIGHEST PRICE"
FROM pizza_types pt
JOIN pizzas p
ON p.pizza_type_id = pt.pizza_type_id
ORDER BY p.price DESC
LIMIT 1;

-- 4] IDENTIFYING THE MOST COMMON SIZE PIZZA ORDERED
SELECT pt.name, p.size 
FROM pizzas p 
INNER JOIN order_details od
ON p.pizza_id = od.pizza_id
INNER JOIN pizza_types pt
ON pt.pizza_type_id = p.pizza_type_id;

-- 5] IDENTIFYING MOST ORDERED PIZZA ALONG WITH ITS QUANTITY
SELECT DISTINCT pt.name, od.quantity, p.price
FROM pizza_types pt
JOIN pizzas p
ON pt.pizza_type_id = p.pizza_type_id
JOIN order_details od
ON p.pizza_id = od.pizza_id
ORDER BY od.quantity DESC
LIMIT 5;


